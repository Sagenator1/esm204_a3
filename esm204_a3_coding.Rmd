---
title: "Testing"
author: "Sage Davis & Allison Gracer"
date: "5/3/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(broom)
```


```{r}
demand_h_l <- read_csv(here("HW3_data.csv"))
```


## Estimate Demand Curves for "low" and "high" income consumers


```{r}

# Low Demand Curve

D_l <- lm(Price_Cents ~ Q_Low_Kwh, data = demand_h_l)

summary(D_l)

D_l_tidy <- tidy(D_l)

# dp_l <- D_l_tidy[2,2] + D_l_tidy[2,1]  # Need x from y = mx + b

D_l_data <- tibble(Q = 0:500000)

# predict_D_low <- predict(D_l, newdata = D_l_data)


D_l_data <- D_l_data %>% 
  mutate(predict_D_low = (Q * D_l$coefficient[2]) + D_l$coefficient[1])

ggplot(data = D_l_data, aes(x = Q, y = predict_D_low)) +
  stat_smooth(method = "lm", color = "green")

ggplot(data = demand_h_l, aes(x = Q_Low_Kwh, y = Price_Cents)) +
  geom_point() +
  stat_smooth(method = "lm", color = "red")


# High Demand Curve

D_h <- lm(Price_Cents ~ Q_High_Kwh, data = demand_h_l)

summary(D_h)

D_h_tidy <- tidy(D_h)

ggplot(data = demand_h_l, aes(x = Q_High_Kwh, y = Price_Cents)) +
  geom_point() +
  stat_smooth(method = "lm", color = "blue")



```

